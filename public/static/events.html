<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Events</title>
    <link rel="stylesheet" type="text/css" href="staticstyle.css" />
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDx5elwS0TL6JHuqgqxdcgTt2BRC-WsXTE&callback=initMap">
    </script>
    <script>
        var latitude;
        var lon;

        function initMap() {

            var output = document.getElementById("out");

            if (!navigator.geolocation){
                output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
                return;
            }

            function success(position) {
                latitude  = position.coords.latitude;
                lon = position.coords.longitude;

                output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + lon + '°</p>';

                var map= {
                    center:new google.maps.LatLng(latitude,lon),
                    zoom:13,
                };
                var mapa = new google.maps.Map(document.getElementById("map"),map);

                var geocoder = new google.maps.Geocoder();
                var infowindow = new google.maps.InfoWindow;

                geocoder.geocode({'location': new google.maps.LatLng(latitude,lon)}, function(results, status) {
                    if (status === 'OK') {
                        mapa.setCenter(new google.maps.LatLng(latitude,lon));
                        var marker = new google.maps.Marker({
                            map: mapa,
                            position: new google.maps.LatLng(latitude,lon)
                        });
                        marker.addListener('click', function() {
                            infowindow.open(map, marker);
                        });
                        infowindow.setContent(results[0].formatted_address);
                        infowindow.open(map, marker);
                        output.innerHTML += '<p>' + results[0].formatted_address +'</p>';
                    } else {
                        alert('Geocode was not successful for the following reason: ' + status);
                    }
                });


            };

            function error() {
                output.innerHTML = "Unable to retrieve your location";
            };

            output.innerHTML = "<p>Locating…</p>";

            navigator.geolocation.getCurrentPosition(success, error);
        }

    </script>
</head>
<body>
<div class="sidebar">
    <a href="../myBooks.php">Home</a>
    <a href="../booksAll.html">All Books</a>
    <a href="authors.html">Authors</a>
    <a href="clasics.html">Clasics</a>
    <a href="bestSellings.html">Best Sellings</a>
    <a href="series.html">Series</a>
    <a href="events.html">Events</a>
    <a href="guide.html">Guide</a>
    <a href="index.html">Index</a>
</div>
<article class="container">
    <h1>Location & Events</h1>
    <section id="out"><h6>Coordinates</h6></section>
    <section id="map"><h6>Location</h6></section>
</article>

</body>
</html>
